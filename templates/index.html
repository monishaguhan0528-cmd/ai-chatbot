<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Chatbot</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<div class="app">
  <header class="header">
    <h1> AI Chat</h1>
    </header>

  <div class="chat-area" id="chat-box"></div>

  <div class="input-area">
    <input type="text" id="message" placeholder="Ask me anything..." />
    <button onclick="sendMessage()">Send ðŸš€</button>
  </div>
</div>

<script>
const BACKEND_URL = "https://ai-chatbot-3-z32r.onrender.com/chat";

async function sendMessage(){
    const input = document.getElementById("message");
    const chatBox = document.getElementById("chat-box");
    const text = input.value.trim();
    if(!text) return;

    chatBox.innerHTML += `<div class="msg user">${text}</div>`;
    input.value = "";
    chatBox.scrollTop = chatBox.scrollHeight;

    const typingId = "typing-" + Date.now();
    chatBox.innerHTML += `
      <div class="msg bot" id="${typingId}">
        <span class="dot"></span><span class="dot"></span><span class="dot"></span>
      </div>
    `;
    chatBox.scrollTop = chatBox.scrollHeight;

    try {
        const res = await fetch(BACKEND_URL, {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({ message: text })
        });

        const data = await res.json();
        document.getElementById(typingId).remove();
        chatBox.innerHTML += `<div class="msg bot">${data.reply}</div>`;
    } catch {
        document.getElementById(typingId).remove();
        chatBox.innerHTML += `<div class="msg bot error">Server error</div>`;
    }

    chatBox.scrollTop = chatBox.scrollHeight;
}
</script>

</body>
</html>